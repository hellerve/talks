\documentclass[aspectratio=169]{beamer}
\usepackage{minted}
\usepackage{listings}
\usetheme{veit}
\title{Enhancing Your Libraries’ Security and Performance through Macros}
\date{\today}
\author{Veit Heller}
\institute{Clojure Meetup Berlin}
\begin{document}
  \maketitle
  \begin{frame}{TL;DR}
    \Large “Just remember that macro programming is not about style; it is about
    power.”

    — Doug Hoyte, Let Over Lambda (Chapter 3)
  \end{frame}
  \begin{frame}[fragile]
    \frametitle{fmt}
    \begin{listing}[H]
      \caption{A safer format}
      \begin{minted}{clojure}
(defmacro fmt [s & args]
  (let [a (dec (count (filter #(not= "" %)
                              (str/split s #"%"))))
        b (count args)]
    (if (= a b)
      `(apply format ~s '~args)
      (exc "arguments to format don’t match (expected " a
           ", got " b ")"))))
      \end{minted}
    \end{listing}
  \end{frame}
  \begin{frame}[fragile]
    \frametitle{defmacro!}
    \begin{listing}[H]
      \caption{A macro utility—or, as Alan Perlin said: “Syntactic sugar causes cancer of the semicolon.”}
      \begin{minted}{clojure}
(defmacro defmacro! [name args & body]
  (let [rm (into {}
                (map (fn [s] [s `(quote ~(gensym))])
                        args))]
    `(defmacro ~name ~args
      `(let ~~(into [] (mapcat reverse rm))
        ~(clojure.walk/postwalk-replace ~rm ~@body)))))
      \end{minted}
    \end{listing}
  \end{frame}
  \begin{frame}{References}
    \begin{itemize}
      \item Greg Hendershott: Fear of Macros
      \item Doug Hoyte: Let Over Lambda
      \item Colin Jones: Mastering Clojure Macros
      \item Paul Graham: On Lisp
      \item These slides: \texttt{https://github.com/hellerve/talks}
      \item A series of blog posts on Scheme macros: \texttt{https://blog.veitheller.de/scheme-macros}
    \end{itemize}
  \end{frame}
  \begin{frame}{The End}
    \Huge Thank you!
    \linebreak
    \linebreak
    \linebreak
    \small Questions?
    \linebreak
    \linebreak
    \tiny Slides at \texttt{https://github.com/hellerve/talks}
  \end{frame}
\end{document}
